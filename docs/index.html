<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KenPom Visualization Dashboard</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <header>
        <h1>KenPom Basketball Analytics</h1>
        <p>Updated daily with the latest statistics</p>
    </header>

    <main>
        <section class="plot-container">
            <h2>Top 100 Teams Overview</h2>
            <img src="./plots/kenpom_top100_eff.png" alt="Top 100 Teams Plot" onerror="handleImageError(this)">
        </section>

        <section class="plot-container">
            <h2>AP Top 25 Teams</h2>
            <img src="./plots/kenpom_ap25_eff.png" alt="AP Top 25 Teams Plot" onerror="handleImageError(this)">
        </section>

        <section class="conferences">
            <h2>Conference Breakdowns</h2>
            <div class="conference-grid">
                <!-- Conference plots will be dynamically listed here -->
            </div>
        </section>
    </main>

    <footer>
        <p>Data source: KenPom.com | Updated: <span id="last-updated"></span></p>
    </footer>

    <script>
        // Update the last-updated date
        document.getElementById('last-updated').textContent = new Date().toISOString().split('T')[0];

        // Error handling for images
        function handleImageError(img) {
            console.error(`Failed to load image: ${img.src}`);
            img.style.display = 'none';
            const error = document.createElement('p');
            error.className = 'error-message';
            error.textContent = `Plot currently unavailable`;
            img.parentNode.appendChild(error);
        }

        // Dynamically load conference plots
        fetch('./plots/conferences/')
            .then(response => response.text())
            .then(html => {
                const plots = html.match(/href=".*\.png"/g) || [];
                const grid = document.querySelector('.conference-grid');
                plots.forEach(plot => {
                    const name = plot.match(/kenpom_(.*)_eff\.png/)[1].toUpperCase();
                    const div = document.createElement('div');
                    div.className = 'conference-plot';
                    div.innerHTML = `
                        <h3>${name}</h3>
                        <img src="./plots/conferences/${plot.match(/"(.*)"/)[1]}" 
                             alt="${name} Conference Plot"
                             onerror="handleImageError(this)">
                    `;
                    grid.appendChild(div);
                });
            })
            .catch(error => console.error('Error loading conference plots:', error));
    </script>

    <style>
        .error-message {
            color: #721c24;
            background-color: #f8d7da;
            border: 1px solid #f5c6cb;
            border-radius: 4px;
            padding: 10px;
            margin-top: 10px;
            text-align: center;
        }
    </style>
</body>
</html>
